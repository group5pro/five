<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.group5.five.web.admin.dao.ProductDao">
    <sql id="selectContent">
     a.product_id,
     a.product_name,
     a.product_picture,
     a.origin_price,
     a.discount_price,
     a.comment_num,
     a.sales_num
    </sql>

    <sql id="TbContentJoins">
         LEFT JOIN category AS b ON a.category_id = b.category_id
    </sql>




    <select id="count" resultType="java.lang.Integer">
        SELECT COUNT(*) FROM product AS a
        <where>
            <if test="productName != null and productName !=''">
                AND a.product_name LIKE CONCAT ('%',#{productName},'%')
            </if>
            <if test="originPrice != null and originPrice !=''">
                AND a.origin_price LIKE CONCAT ('%',#{originPrice},'%')
            </if>
        </where>
    </select>


    <select id="selectByPage" resultType="Product" parameterType="java.util.Map">
        SELECT
        <include refid="selectContent"/>
        FROM
        product AS a
        <where>
            <if test="product.productName != null and product.productName != ''">
                AND a.product_name LIKE CONCAT ('%',#{product.productName},'%')
            </if>
            <if test="product.originPrice != null and product.originPrice != ''">
                AND a.origin_price LIKE CONCAT ('%',#{product.originPrice},'%')
            </if>
        </where>
        LIMIT #{start},#{length}
    </select>


    <select id="selectById" resultType="Product">
        SELECT
        <include refid="selectContent"/>
        FROM
        tb_content AS a
        <include refid="TbContentJoins"/>
        WHERE a.product_id = #{productId}
    </select>

    <insert id="insertProduct">
  INSERT INTO product
	(product_id,
	product_name,
	product_picture,
	origin_price,
	discount_price,
	comment_num,
	sales_num,
	category_id
	)
	VALUES
	(
	#{productId},
	#{productName},
	#{productPicture},
	#{originPrice},
	#{discountPrice},
	#{commentNum},
	#{salesNum},
	#{categoryId},
	)

    </insert>

    <delete id="deleteById">
        DELETE
        FROM product
        WHERE a.product_id = #{productId}
    </delete>


    <update id="updateProduct">
      UPDATE
      product
         SET
	    product_name = #{productName},
	    product_picture = #{productPicture},
	    origin_price=#{originPrice},
	    discount_price=#{discountPrice},
	    comment_num = #{commentNum},
	    sales_num =#{salesNum},
	    category_id=#{categoryId}
        WHERE a.product_id = #{productId}

    </update>

    <delete id="deleteProduct">
        DELETE FROM product
        WHERE productId  IN
        <foreach collection="array" open="(" close=")" item="id" separator=",">
            #{id}
        </foreach>

    </delete>
</mapper>